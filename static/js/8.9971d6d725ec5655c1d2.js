webpackJsonp([8],{"9Udt":function(t,e){},c1um:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("Gu7T"),a=n.n(r),s=n("BO1k"),o=n.n(s),i=n("Xxa5"),u=n.n(i),c=n("exGp"),l=n.n(c),d=n("v1w/"),h=(n("oAV5"),n("ONoB")),f=(n("DHPL"),n("YaEn"),n("o/zv"),Object(d.c)()),p=f.contractAddress,b=(f.contractName,f.marketContractName,f.chatroomContractName,f.likeContractName,f.BNSContractAddress,f.BNSContractName,f.ordiTokenName,f.lotteryContractName2),v=p,g=Object(d.d)(),m={name:"HistoryPage",components:{},data:function(){return{bSignedIn:d.g.isUserSignedIn(),bLatestInReq:!1,latestRoundInfo:{round:0,state:0,totalBetCount:0,startAtStx:0,endAtStx:0,endAtBtc:0},bHasReqHistory:!1,bInReqHistory:!1,curRound:1,maxRound:1e6,curPage:1,bHistoryHasInfo:!1,bInReqAllBetPage:!1,betCountPerPage:25,curRoundInfo:{startAtStx:0,endAtStx:0,endAtBtc:0,jackpot:"",totalBetCount:0,hashList:[],winners:[]},allBetList:[],myBetList:[],HITS_NO_LIST:[!1,!1,!1,!1,!1]}},mounted:function(){var t=this;return l()(u.a.mark(function e(){return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t.requestBaseSummary(),t.requestHistorySummary(0);case 2:case"end":return e.stop()}},e,t)}))()},methods:{requestBaseSummary:function(){var t=this;return l()(u.a.mark(function e(){var n,r,a;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.bLatestInReq=!0,n={contractAddress:p,contractName:b,functionName:"get_summary",functionArgs:[],network:g,senderAddress:v},e.next=4,Object(h.f)(n);case 4:r=e.sent,a=Object(h.i)(r),t.latestRoundInfo={round:a.round.value,state:a.state.value,totalBetCount:a.bet_count.value,startAtStx:a.start_at.value,endAtStx:a.end_at.value,endAtBtc:a.end_at_btc.value},t.bLatestInReq=!1,t.maxRound=t.latestRoundInfo.round,t.combineLatestQueries();case 10:case"end":return e.stop()}},e,t)}))()},requestHistorySummary:function(t){var e=this;return l()(u.a.mark(function n(){var r,s,i,c,l,f,m,_,I,R,y,x,A,w,S,B,k,j,q,C,H,L;return u.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return e.bInReqHistory=!0,s=e.bSignedIn?"get_history_with_user":"get_history",i=e.bSignedIn?[Object(h.x)(t),Object(h.u)(Object(d.a)())]:[Object(h.x)(t)],c={contractAddress:p,contractName:b,functionName:s,functionArgs:i,network:g,senderAddress:v},n.next=6,Object(h.f)(c);case 6:if(l=n.sent,f={round:0,bHasInfo:!1,startAtStx:0,endAtStx:0,endAtBtc:0,jackpot:"",totalBetCount:0,hashes:[],winners:[]},m=e.bSignedIn?l.data.base:l,f.round=Object(h.i)(m.data.t),9!=m.data.v.type){n.next=14;break}f.bHasInfo=!1,n.next=61;break;case 14:for(f.bHasInfo=!0,_=m.data.v.value.data,f.startAtStx=Object(h.i)(_.start_at_stx),f.endAtStx=Object(h.i)(_.end_at_stx),f.endAtBtc=Object(h.i)(_.end_at_btc),f.jackpot=Object(h.i)(_.jackpot),f.totalBetCount=Object(h.i)(_.bet_count),I=Object(h.i)(_.hashes),R=!0,y=!1,x=void 0,n.prev=25,A=o()(I);!(R=(w=A.next()).done);R=!0)S=w.value,f.hashes.push(S.value);n.next=33;break;case 29:n.prev=29,n.t0=n.catch(25),y=!0,x=n.t0;case 33:n.prev=33,n.prev=34,!R&&A.return&&A.return();case 36:if(n.prev=36,!y){n.next=39;break}throw x;case 39:return n.finish(36);case 40:return n.finish(33);case 41:for(B=Object(h.i)(_.winners),k=!0,j=!1,q=void 0,n.prev=45,C=o()(B);!(k=(H=C.next()).done);k=!0)L=H.value,f.winners.push(L.value);n.next=53;break;case 49:n.prev=49,n.t1=n.catch(45),j=!0,q=n.t1;case 53:n.prev=53,n.prev=54,!k&&C.return&&C.return();case 56:if(n.prev=56,!j){n.next=59;break}throw q;case 59:return n.finish(56);case 60:return n.finish(53);case 61:if(e.curRound=f.round,e.curRoundInfo.startAtStx=f.startAtStx,e.curRoundInfo.endAtStx=f.endAtStx,e.curRoundInfo.endAtBtc=f.endAtBtc,e.curRoundInfo.jackpot=f.jackpot,e.curRoundInfo.totalBetCount=f.totalBetCount,e.curRoundInfo.hashList.splice(0,e.curRoundInfo.hashList.length),e.curRoundInfo.hashList=f.hashes.map(function(t){return t.substr(2,64)}),e.curRoundInfo.winners.splice(0,e.curRoundInfo.winners.length),(r=e.curRoundInfo.winners).push.apply(r,a()(f.winners)),e.bInReqHistory=!1,e.bHasReqHistory=!0,e.bHistoryHasInfo=f.bHasInfo,e.bHistoryHasInfo){n.next=78;break}return e.combineLatestQueries(),e.bSignedIn&&e.genMyBet(Object(h.i)(l.data.user_bet)),n.abrupt("return");case 78:e.queryCurAllBetPage(1),e.bSignedIn&&e.genMyBet(Object(h.i)(l.data.user_bet));case 80:case"end":return n.stop()}},n,e,[[25,29,33,41],[34,,36,40],[45,49,53,61],[54,,56,60]])}))()},combineLatestQueries:function(){!this.bLatestInReq&&this.bHasReqHistory&&(this.bHistoryHasInfo||this.curRound!=this.latestRoundInfo.round||(this.curRoundInfo.startAtStx=this.latestRoundInfo.startAtStx,this.curRoundInfo.endAtStx=this.latestRoundInfo.endAtStx,this.curRoundInfo.endAtBtc=this.latestRoundInfo.endAtBtc,this.curRoundInfo.jackpot="",this.curRoundInfo.totalBetCount=this.latestRoundInfo.totalBetCount,this.curRoundInfo.hashList.splice(0,this.curRoundInfo.hashList.length),this.curRoundInfo.winners.splice(0,this.curRoundInfo.winners.length),this.queryCurAllBetPage(1)))},genMyBet:function(t){if(this.myBetList.splice(0,this.myBetList.length),t){var e=!0,n=!1,r=void 0;try{for(var a,s=o()(t.value);!(e=(a=s.next()).done);e=!0){var i=a.value;this.myBetList.push({chs:i.value,hits:this.genHits(this.curRoundInfo.jackpot,i.value)})}}catch(t){n=!0,r=t}finally{try{!e&&s.return&&s.return()}finally{if(n)throw r}}}},queryCurAllBetPage:function(t){var e=this;return l()(u.a.mark(function n(){var r,a,s,i,c,l,f,m,_,I,R,y;return u.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(e.allBetList.splice(e.allBetList,e.allBetList.length),!(Math.ceil(e.curRoundInfo.totalBetCount/e.betCountPerPage)<t)){n.next=3;break}return n.abrupt("return");case 3:return e.bInReqAllBetPage=!0,r={contractAddress:p,contractName:b,functionName:"get_bet_bunch",functionArgs:[Object(h.x)(e.curRound),Object(h.x)(t-1)],network:g,senderAddress:v},n.next=7,Object(h.f)(r);case 7:for(a=n.sent,s=Object(h.i)(a),i=!0,c=!1,l=void 0,n.prev=12,f=o()(s.value);!(i=(m=f.next()).done);i=!0)_=m.value,I=[_.value.p.value,_.value.dv.value],R=I[0],y=I[1],e.allBetList.push({bSelf:e.bSignedIn&&R==Object(d.a)(),brAddr:R.substr(0,4)+".."+R.substr(R.length-4,4),addr:R,chs:y,hits:e.genHits(e.curRoundInfo.jackpot,y)});n.next=20;break;case 16:n.prev=16,n.t0=n.catch(12),c=!0,l=n.t0;case 20:n.prev=20,n.prev=21,!i&&f.return&&f.return();case 23:if(n.prev=23,!c){n.next=26;break}throw l;case 26:return n.finish(23);case 27:return n.finish(20);case 28:e.bInReqAllBetPage=!1;case 29:case"end":return n.stop()}},n,e,[[12,16,20,28],[21,,23,27]])}))()},onChangePage:function(t){this.bInRequestMyBets=!0,this.queryCurAllBetPage(t)},onChangeRound:function(t){var e=parseInt(t);e&&(this.curRound=Math.min(Math.max(1,e),this.maxRound),this.requestHistorySummary(this.curRound))},genHits:function(t,e){if(this.curRoundInfo.jackpot.length<=0)return this.HITS_NO_LIST;for(var n=[],r=0;r<5;r++)n[r]=t.substr(r,1)==e.substr(r,1);return n}}},_={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("div",{attrs:{id:"main"}},[n("div",[n("span",{attrs:{id:"roundTip"}},[t._v("Round: ")]),t._v(" "),n("el-input-number",{attrs:{id:"round",min:1,max:t.maxRound,disabled:t.bLatestInReq||t.bInReqHistory,size:"large"},on:{change:t.onChangeRound},model:{value:t.curRound,callback:function(e){t.curRound=e},expression:"curRound"}}),t._v(" "),n("span",{attrs:{id:"titleGap"}})],1),t._v(" "),n("el-descriptions",{directives:[{name:"loading",rawName:"v-loading",value:t.bLatestInReq||t.bInReqHistory,expression:"bLatestInReq || bInReqHistory"}],attrs:{id:"summaryArea",column:3,border:""}},[n("el-descriptions-item",[n("template",{slot:"label"},[n("span",{staticStyle:{"white-space":"nowrap"}},[t._v("Start block")])]),t._v(" "),n("span",{staticStyle:{"white-space":"nowrap","padding-left":"8px","padding-right":"8px"}},[t._v(t._s(t.curRoundInfo.startAtStx>0?" "+t.curRoundInfo.startAtStx+" ":"Wait bet to start"))])],2),t._v(" "),n("el-descriptions-item",[n("template",{slot:"label"},[n("span",{staticStyle:{"white-space":"nowrap"}},[t._v("End block")])]),t._v(" "),n("span",{staticStyle:{"white-space":"nowrap"}},[t._v(t._s(t.curRoundInfo.endAtStx>0?t.curRoundInfo.endAtStx:"-"))])],2),t._v(" "),n("el-descriptions-item",[n("template",{slot:"label"},[n("span",{staticStyle:{"white-space":"nowrap"}},[t._v("End Bitcoin block")])]),t._v(" "),n("span",{staticStyle:{"white-space":"nowrap"}},[t._v(t._s(t.curRoundInfo.endAtBtc>0?t.curRoundInfo.endAtBtc:"-"))])],2),t._v(" "),n("el-descriptions-item",{attrs:{span:3}},[n("template",{slot:"label"},[n("span",{staticStyle:{"white-space":"nowrap"}},[t._v("Jackpot")])]),t._v(" "),t.curRoundInfo.hashList.length>0?n("div",{attrs:{id:"jackpotArea"}},[t._l(t.curRoundInfo.hashList.length,function(e){return n("div",{key:e,staticClass:"equalWidth"},[t._v("\n            "+t._s(t.curRoundInfo.hashList[e-1].substr(0,50))),n("span",{staticClass:"bold"},[t._v(t._s(t.curRoundInfo.hashList[e-1].substr(50,1)))]),t._v(t._s(t.curRoundInfo.hashList[e-1].substr(51,13))+"("),n("a",{staticClass:"mylink",attrs:{href:"https://mempool.space/block/"+t.curRoundInfo.hashList[e-1],target:"_blank"}},[t._v(t._s(t.curRoundInfo.endAtBtc+5+e))]),t._v(")\n          ")])}),t._v(" "),n("div",[t._v("Result: "),n("span",{staticClass:"equalWidth bold result"},[t._v(t._s(t.curRoundInfo.jackpot))])])],2):n("div",[t._v("\n          -\n        ")])],2),t._v(" "),n("el-descriptions-item",[n("template",{slot:"label"},[n("span",{staticStyle:{"white-space":"nowrap"}},[t._v("Total bets")])]),t._v(" "),n("span",{staticStyle:{"white-space":"nowrap","padding-left":"8px","padding-right":"8px"}},[t._v(t._s(t.curRoundInfo.totalBetCount))])],2),t._v(" "),n("el-descriptions-item",[n("template",{slot:"label"},[n("span",{staticStyle:{"white-space":"nowrap"}},[t._v("Winner"+t._s(t.curRoundInfo.winners.length>1?"s":""))])]),t._v("\n        "+t._s(t.curRoundInfo.winners.length>0?t.curRoundInfo.winners.join("\n"):this.curRound<this.latestRoundInfo.round?"None":"-")+"\n      ")],2)],1),t._v(" "),n("div",{attrs:{id:"horArea"}},[n("el-card",{directives:[{name:"loading",rawName:"v-loading",value:t.bInReqHistory,expression:"bInReqHistory"}],attrs:{id:"allArea"}},[n("div",{attrs:{slot:"header"},slot:"header"},[n("div",[t._v("All bets: "+t._s(t.curRoundInfo.totalBetCount))]),t._v(" "),n("el-pagination",{attrs:{id:"pagetool","page-size":200,layout:"prev, pager, next","hide-on-single-page":"","current-page":t.curPage,total:t.curRoundInfo.totalBetCount},on:{"current-change":t.onChangePage,"update:currentPage":function(e){t.curPage=e},"update:current-page":function(e){t.curPage=e}}})],1),t._v(" "),n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.bInReqAllBetPage,expression:"bInReqAllBetPage"}],attrs:{data:t.allBetList,"empty-text":"Empty","max-height":t.curRoundInfo.totalBetCount>200?548:595}},[n("el-table-column",{attrs:{label:"",width:"60"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n              "+t._s(200*(t.curPage-1)+e.$index+1)+"\n            ")]}}])}),t._v(" "),n("el-table-column",{attrs:{label:"Address",width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-link",{style:{color:"black",fontWeight:e.row.bSelf?"bold":"normal"},attrs:{href:"https://explorer.hiro.so/address/"+e.row.addr+"?chain=mainnet",target:"_blank"}},[t._v(t._s(e.row.brAddr+(e.row.bSelf?"(me)":"")))])]}}])}),t._v(" "),n("el-table-column",{attrs:{label:"Sequence"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",{staticClass:"seq equalWidth"},t._l(e.row.hits.length,function(r){return n("span",{key:r,class:e.row.hits[r-1]?"bold":""},[t._v(t._s(e.row.chs[r-1]))])}),0)]}}])})],1)],1),t._v(" "),t.bSignedIn?n("el-card",{directives:[{name:"loading",rawName:"v-loading",value:t.bInReqHistory,expression:"bInReqHistory"}],attrs:{id:"mineArea"}},[n("div",{attrs:{slot:"header"},slot:"header"},[n("span",[t._v("My bets: "+t._s(t.myBetList.length))]),t._v(" "),n("el-button",{staticClass:"betbtn",style:{visibility:"hidden"},attrs:{plain:"",type:"primary",size:"small"}},[t._v("\n             \n          ")])],1),t._v(" "),n("el-table",{attrs:{data:t.myBetList,"empty-text":"Empty","max-height":580,"show-header":!1,size:"small"}},[n("el-table-column",{attrs:{type:"index",width:"45"}}),t._v(" "),n("el-table-column",{scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",{staticClass:"seq equalWidth"},t._l(e.row.hits.length,function(r){return n("span",{key:r,class:e.row.hits[r-1]?"bold":""},[t._v(t._s(e.row.chs[r-1]))])}),0)]}}],null,!1,129432233)})],1)],1):t._e()],1)],1)])},staticRenderFns:[]};var I=n("VU/8")(m,_,!1,function(t){n("9Udt")},"data-v-d97853a6",null);e.default=I.exports},"o/zv":function(t,e,n){(function(t){function n(t,e){for(var n=0,r=t.length-1;r>=0;r--){var a=t[r];"."===a?t.splice(r,1):".."===a?(t.splice(r,1),n++):n&&(t.splice(r,1),n--)}if(e)for(;n--;n)t.unshift("..");return t}function r(t,e){if(t.filter)return t.filter(e);for(var n=[],r=0;r<t.length;r++)e(t[r],r,t)&&n.push(t[r]);return n}e.resolve=function(){for(var e="",a=!1,s=arguments.length-1;s>=-1&&!a;s--){var o=s>=0?arguments[s]:t.cwd();if("string"!=typeof o)throw new TypeError("Arguments to path.resolve must be strings");o&&(e=o+"/"+e,a="/"===o.charAt(0))}return e=n(r(e.split("/"),function(t){return!!t}),!a).join("/"),(a?"/":"")+e||"."},e.normalize=function(t){var s=e.isAbsolute(t),o="/"===a(t,-1);return(t=n(r(t.split("/"),function(t){return!!t}),!s).join("/"))||s||(t="."),t&&o&&(t+="/"),(s?"/":"")+t},e.isAbsolute=function(t){return"/"===t.charAt(0)},e.join=function(){var t=Array.prototype.slice.call(arguments,0);return e.normalize(r(t,function(t,e){if("string"!=typeof t)throw new TypeError("Arguments to path.join must be strings");return t}).join("/"))},e.relative=function(t,n){function r(t){for(var e=0;e<t.length&&""===t[e];e++);for(var n=t.length-1;n>=0&&""===t[n];n--);return e>n?[]:t.slice(e,n-e+1)}t=e.resolve(t).substr(1),n=e.resolve(n).substr(1);for(var a=r(t.split("/")),s=r(n.split("/")),o=Math.min(a.length,s.length),i=o,u=0;u<o;u++)if(a[u]!==s[u]){i=u;break}var c=[];for(u=i;u<a.length;u++)c.push("..");return(c=c.concat(s.slice(i))).join("/")},e.sep="/",e.delimiter=":",e.dirname=function(t){if("string"!=typeof t&&(t+=""),0===t.length)return".";for(var e=t.charCodeAt(0),n=47===e,r=-1,a=!0,s=t.length-1;s>=1;--s)if(47===(e=t.charCodeAt(s))){if(!a){r=s;break}}else a=!1;return-1===r?n?"/":".":n&&1===r?"/":t.slice(0,r)},e.basename=function(t,e){var n=function(t){"string"!=typeof t&&(t+="");var e,n=0,r=-1,a=!0;for(e=t.length-1;e>=0;--e)if(47===t.charCodeAt(e)){if(!a){n=e+1;break}}else-1===r&&(a=!1,r=e+1);return-1===r?"":t.slice(n,r)}(t);return e&&n.substr(-1*e.length)===e&&(n=n.substr(0,n.length-e.length)),n},e.extname=function(t){"string"!=typeof t&&(t+="");for(var e=-1,n=0,r=-1,a=!0,s=0,o=t.length-1;o>=0;--o){var i=t.charCodeAt(o);if(47!==i)-1===r&&(a=!1,r=o+1),46===i?-1===e?e=o:1!==s&&(s=1):-1!==e&&(s=-1);else if(!a){n=o+1;break}}return-1===e||-1===r||0===s||1===s&&e===r-1&&e===n+1?"":t.slice(e,r)};var a="b"==="ab".substr(-1)?function(t,e,n){return t.substr(e,n)}:function(t,e,n){return e<0&&(e=t.length+e),t.substr(e,n)}}).call(e,n("W2nU"))}});